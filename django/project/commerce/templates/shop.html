{% extends "base.html" %}

{% load static %}
{% block title %}
Zap-Resell Shop
{% endblock title %}

{% block content %}
<!-- Modal -->
<div class="modal fade bg-white" id="templatemo_search" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="w-100 pt-1 mb-5 text-right">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form action="" method="get" class="modal-content modal-body border-0 p-0">
            <div class="input-group mb-2">
                <input type="text" class="form-control" id="inputModalSearch" name="q" placeholder="Search ...">
                <button type="submit" class="input-group-text bg-success text-light">
                    <i class="fa fa-fw fa-search text-white"></i>
                </button>
            </div>
        </form>
    </div>
</div>



<!-- Start Content -->
<div class="container py-5">
    <div class="row">

        <div class="col-lg-3">
            <h1 class="h2 pb-4 text-success">Categories</h1>
            <ul id="categoryList">
            {% for category in categories %}
            <li class="pb-3">
                <a href="javascript:void(0)" 
                class="collapsed d-flex justify-content-between h3 text-decoration-none category-link"
                data-cat="{{ category.id }}">
                {{ category.name }}
                <i class="fa fa-fw fa-chevron-circle-right mt-1"></i>
                </a>
            </li>
            {% endfor %}
</ul>

        </div>



        <div class="col-lg-9">
            <div class="row">
                <ul id="typeList" class="list-inline shop-top-menu pb-3 pt-1">
    <li class="list-inline-item">
        <a href="javascript:void(0)" class="h3 text-dark text-decoration-none mr-3 type-link" data-type="all">All</a>
    </li>
    <li class="list-inline-item">
        <a href="javascript:void(0)" class="h3 text-dark text-decoration-none mr-3 type-link" data-type="Male">Men's</a>
    </li>
    <li class="list-inline-item">
        <a href="javascript:void(0)" class="h3 text-dark text-decoration-none mr-3 type-link" data-type="Female">Women's</a>
    </li>
    <li class="list-inline-item">
        <a href="javascript:void(0)" class="h3 text-dark text-decoration-none type-link" data-type="Unisex">Unisex's</a>
    </li>
</ul>

                <div class="col-md-6 pb-4">
                <div class="relative w-full d-flex max-w-xs">
                    <select id="sort"
                    class="form-control appearance-none w-full rounded-lg border border-gray-300 px-4 py-2 pr-10 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer">
                    <option value="featured">Featured</option>
                    <option value="low">↑ Price (Low to High)</option>
                    <option value="high">↓ Price (High to Low)</option>
                    </select>
                    <!-- Custom dropdown arrow -->
                    <span style="position: relative; top: 9px; right: 25px;" class="pointer-events-none">
                    ▼
                    </span>
                </div>
                </div>

            </div>
            <div class="row">
                {% for product in products  %}
                    <div class="col-md-4">
                    <div class="card mb-4 product-wap rounded-0">
                        <div class="card rounded-0">
                            <img class="card-img rounded-0 img-fluid" src="{{product.image.url}}" alt="Product Image" style="height: 300px; object-fit: cover;">
                            <div
                                class="card-img-overlay rounded-0 product-overlay d-flex align-items-center justify-content-center">
                                <ul class="list-unstyled">

                                    <li><a class="btn btn-success text-white mt-2" href="shop-single.html"><i
                                                class="far fa-eye"></i></a></li>
                                    <li><a class="btn btn-success text-white mt-2" href="shop-single.html"><i
                                                class="fas fa-cart-plus"></i></a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="card-body">
                            <a href="shop-single.html" class="h3 text-decoration-none">{{product.name | truncatewords:9}}</a>
                            <ul class="list-unstyled d-flex justify-content-center mb-1">
                                <li>
                                    <i class="text-warning fa fa-star"></i>
                                    <i class="text-warning fa fa-star"></i>
                                    <i class="text-warning fa fa-star"></i>
                                    <i class="text-warning fa fa-star"></i>
                                    <i class="text-warning fa fa-star"></i>
                                </li>
                            </ul>
                            <p class="text-center mb-0">₹ {{product.discounted_price}}</p>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col-md-12 text-center py-5">
                    <h3 class="text-success">No products found in this category.</h3>
                </div>
                {% endfor %}
                
            </div>
        </div>

    </div>
</div>
<!-- End Content -->

<!-- Start Brands -->
<section class="bg-light py-5">
    <div class="container my-4">
        <div class="row text-center py-3">
            <div class="col-lg-6 m-auto">
                <h1 class="h1">Our Brands</h1>
                <p>
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                    Lorem ipsum dolor sit amet.
                </p>
            </div>
            <div class="col-lg-9 m-auto tempaltemo-carousel">
                <div class="row d-flex flex-row">
                    <!--Controls-->
                    <div class="col-1 align-self-center">
                        <a class="h1" href="#multi-item-example" role="button" data-bs-slide="prev">
                            <i class="text-light fas fa-chevron-left"></i>
                        </a>
                    </div>
                    <!--End Controls-->

                    <!--Carousel Wrapper-->
                    <div class="col">
                        <div class="carousel slide carousel-multi-item pt-2 pt-md-0" id="multi-item-example"
                            data-bs-ride="carousel">
                            <!--Slides-->
                            <div class="carousel-inner product-links-wap" role="listbox">

                                <!--First slide-->
                                <div class="carousel-item active">
                                    <div class="row">
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_01.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_02.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_03.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_04.png" %}" alt="Brand Logo"></a>
                                        </div>
                                    </div>
                                </div>
                                <!--End First slide-->

                                <!--Second slide-->
                                <div class="carousel-item">
                                    <div class="row">
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_01.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_02.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_03.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_04.png" %}" alt="Brand Logo"></a>
                                        </div>
                                    </div>
                                </div>
                                <!--End Second slide-->

                                <!--Third slide-->
                                <div class="carousel-item">
                                    <div class="row">
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_01.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_02.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_03.png" %}" alt="Brand Logo"></a>
                                        </div>
                                        <div class="col-3 p-md-5">
                                            <a href="#"><img class="img-fluid brand-img" src="{% static "assets/img/brand_04.png" %}" alt="Brand Logo"></a>
                                        </div>
                                    </div>
                                </div>
                                <!--End Third slide-->

                            </div>
                            <!--End Slides-->
                        </div>
                    </div>
                    <!--End Carousel Wrapper-->

                    <!--Controls-->
                    <div class="col-1 align-self-center">
                        <a class="h1" href="#multi-item-example" role="button" data-bs-slide="next">
                            <i class="text-light fas fa-chevron-right"></i>
                        </a>
                    </div>
                    <!--End Controls-->
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {

  // ---------- CATEGORY FILTER ----------
  document.querySelectorAll('.category-link').forEach(link => {
    link.addEventListener('click', () => {
      const catId = link.dataset.cat;
      const url = new URL(window.location.href);

      if (catId) url.searchParams.set('cat', catId);
      else url.searchParams.delete('cat');

      window.location.href = url.toString();
    });
  });

  // ---------- TYPE FILTER ----------
  document.querySelectorAll('.type-link').forEach(link => {
    link.addEventListener('click', () => {
      const type = link.dataset.type;
      const url = new URL(window.location.href);

      if (type && type !== 'all') url.searchParams.set('type', type);
      else url.searchParams.delete('type');

      window.location.href = url.toString();
    });
  });

  // ---------- SORT FILTER ----------
  const sortSelect = document.getElementById('sort');
  if (sortSelect) {
    const currentParams = new URLSearchParams(window.location.search);
    const activeSort = currentParams.get('sort');
    if (activeSort) sortSelect.value = activeSort;

    sortSelect.addEventListener('change', function() {
      const selectedOption = this.value;
      const url = new URL(window.location.href);
      url.searchParams.set('sort', selectedOption);
      window.location.href = url.toString();
    });
  }

  // ---------- HIGHLIGHT ACTIVE CATEGORY ----------
  const activeCat = new URLSearchParams(window.location.search).get('cat');
  if (activeCat) {
    const activeLink = document.querySelector(`.category-link[data-cat="${activeCat}"]`);
    if (activeLink) {
      activeLink.classList.add('text-success');
      activeLink.style.fontWeight = "600";
    }
  }

  // ---------- HIGHLIGHT ACTIVE TYPE ----------
  const activeType = new URLSearchParams(window.location.search).get('type');
  if (activeType) {
    const activeTypeLink = document.querySelector(`.type-link[data-type="${activeType}"]`);
    if (activeTypeLink) {
      activeTypeLink.classList.add('text-success');
      activeTypeLink.style.fontWeight = "600";
    }
  } else {
    // Default highlight for "All"
    const allLink = document.querySelector(`.type-link[data-type="all"]`);
    if (allLink) {
      allLink.classList.add('text-success');
      allLink.style.fontWeight = "600";
    }
  }

});

</script>

<!--End Brands-->
{% endblock content %}